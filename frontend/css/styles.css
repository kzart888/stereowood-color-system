/* ============================================
   叠雕画颜色管理系统 - 样式表
   文件路径: frontend/css/styles.css
   ============================================ */

/* ============================================
   基础样式
   ============================================ */
body {
    font-family: 'Microsoft YaHei', Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f5f5f5;
}

/* 全局设计变量 */
:root {
    --sw-gap-xs: 2px;
    --sw-gap-sm: 4px;
    --sw-gap-md: 6px;
    --sw-gap-lg: 8px;
    --sw-actions-gap: 8px; /* 统一母级工具按钮间距 */
    --sw-radius-sm: 4px;
    --sw-radius-md: 6px;
    --sw-card-padding: 4px 6px 8px;
    --sw-header-padding: 6px 6px 4px;
    --sw-chip-gap: 4px;
    --sw-thumb-size: 80px;
    --sw-add-btn-bg: #6f42c1; /* 优雅紫色基色 */
    --sw-add-btn-bg-hover: #5a34a0; /* hover 深一些 */
    --sw-add-btn-bg-active: #4b2c85; /* active 更深 */
}

/* (已移除 sticky 顶部特性样式) */

/* [HEADER] Sticky 顶部栏与布局（搜索功能加入前的基础结构） */
.app-header-sticky { position:sticky; top:0; z-index:1000; background:transparent; backdrop-filter: none; border-bottom:none; box-shadow:none; }
.app-header-bar { display:grid; grid-template-columns:auto 1fr auto; align-items:end; gap:16px; padding:6px 14px 4px; }
.app-header-left { display:flex; align-items:center; min-width:0; }
.app-title-badge { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); padding:6px 14px 6px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.12); }
.app-title { font-size:18px; margin:0; font-weight:600; white-space:nowrap; max-width:420px; overflow:hidden; text-overflow:ellipsis; color:#fff; }
.app-header-center { min-width:0; display:flex; }
/* 自定义 Tab 按钮组 */
.tab-switch-group { display:inline-flex; border-radius:6px; overflow:hidden; background:rgba(118,75,162,0.12); box-shadow:0 0 0 1px rgba(118,75,162,0.25) inset; }
.tab-switch-group .tab-switch { font:inherit; cursor:pointer; border:none; background:transparent; padding:6px 14px; font-size:13px; color:#4a3466; line-height:1; position:relative; transition:background .18s ease, color .18s ease; }
.tab-switch-group .tab-switch + .tab-switch { border-left:1px solid rgba(118,75,162,0.3); }
.tab-switch-group .tab-switch.active { background:linear-gradient(135deg,#6f42c1,#5a34a0); color:#fff; box-shadow:0 0 0 1px rgba(0,0,0,0.05) inset; }
.tab-switch-group .tab-switch:not(.active):hover { background:rgba(118,75,162,0.18); }
.tab-switch-group .tab-switch:focus-visible { outline:2px solid rgba(111,66,193,0.55); outline-offset:-2px; }
.app-header-tools { display:flex; align-items:center; gap:10px; flex-wrap:nowrap; }
.app-header-tools .dual-toggle-group { display:inline-flex; }
.app-header-tools .el-button + .el-button { margin-left:0 !important; }
@media (max-width: 980px) {
    .app-header-bar { grid-template-columns:1fr; grid-auto-rows:auto; }
    .app-header-center { order:2; justify-content:flex-start; }
    .app-header-tools { flex-wrap:wrap; order:3; }
}
.tab-panels-wrapper { padding:10px 4px 60px; }

.main-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 8px 12px;
}

.system-header {
    text-align: center;
    margin-bottom: 8px;
    padding: 12px 20px; /* compact vertical */
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 10px;
    color: white;
}
.system-header h1 {
    margin: 0;
    font-size: 20px;
    line-height: 1.2;
    font-weight: 600;
}
.system-header.compact p { display: none; }


/* 作品配色管理卡片（紧凑化后） */
.artwork-bar {
    background: #fff;
    margin: var(--sw-gap-md) var(--sw-gap-md) var(--sw-gap-lg) var(--sw-gap-md);
    border-radius: var(--sw-radius-md);
    box-shadow: 0 1px 4px rgba(0,0,0,0.3);
    overflow: hidden;
    padding: var(--sw-card-padding);
}

.artwork-header {
    padding: var(--sw-header-padding);
    background: #f8f9fa;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.artwork-title { font-size:16px; font-weight:600; color:#222; margin:0; }

.color-actions { display:flex; align-items:center; gap: var(--sw-actions-gap); flex-shrink:0; }
.color-actions .el-button + .el-button { margin-left:0 !important; }
.inline-actions { display:flex; align-items:center; gap: var(--sw-actions-gap); }
.inline-actions .el-button + .el-button { margin-left:0 !important; }


/* 旧的 artwork 区域重复样式已移除，使用上方紧凑化版本 */

/* 方案块内边距 & 头部间距恢复为紧凑但不拥挤 */
.scheme-bar { padding:6px 6px 8px; border-bottom:1px solid #f0f0f0; }
.scheme-header { margin-bottom:6px; gap: var(--sw-actions-gap); }
/* 统一缩略图尺寸为 80x80 方形 */
.scheme-thumbnail { width: var(--sw-thumb-size); height: var(--sw-thumb-size); position:relative; display:flex; align-items:center; justify-content:center; font-size:12px; color:#777; }

/* 表格适度压缩行内边距 */
.layer-table th, .layer-table td { padding:6px 6px; }

.scheme-bar:last-child {
    border-bottom: none;
}

.scheme-header { display:flex; align-items:center; gap: var(--sw-actions-gap); margin-bottom:8px; }

.scheme-thumbnail {
    border-radius: var(--sw-radius-sm);
    border: 2px solid #ddd;
    background-size: cover;
    background-position: center;
    flex-shrink: 0;
    cursor: pointer;
}
.scheme-thumbnail.no-image { background:#fafafa; border-style:dashed; cursor: default; }

/* 表单辅助提示与成功提示 */
.form-hint { font-size:12px; color:#777; margin-top:4px; line-height:1.4; }
.form-hint.success-hint { color:#2f9e44; }
.form-hint.error-hint { color:#d93025; }
/* 让对话框中的提示换行并独占一行（防止与输入框并排） */
.scheme-dialog .el-form-item__content .form-hint { flex-basis:100%; width:100%; }
.scheme-dialog .el-form-item__content { align-items:flex-start; }

/* 预览浮层 */
.thumb-preview-overlay { position:fixed; width:calc(var(--sw-thumb-size) * 4); height:calc(var(--sw-thumb-size) * 4); background:#fff center/cover no-repeat; box-shadow:0 6px 22px rgba(0,0,0,0.35); border:2px solid #fff; border-radius:6px; z-index:2000; opacity:0; pointer-events:none; transition:opacity .16s ease; }
.thumb-preview-overlay.show { opacity:1; pointer-events:auto; }
.thumb-preview-overlay::after { content:""; position:absolute; inset:0; border-radius:6px; box-shadow:inset 0 0 0 1px rgba(0,0,0,0.08); }

.scheme-name {
    font-size: 16px;
    font-weight: bold;
    color: #409EFF;
}

/* 表格样式 */
.layer-table {
    width: 100%;
    border-collapse: collapse;
}

.layer-table th,
.layer-table td {
    border: 1px solid #ddd;
    padding: 4px;
    text-align: center;
    font-size: 12px;
}

.layer-table th {
    background: #f5f5f5;
    font-weight: bold;
}


/* ============================================
   配方编辑器样式
   ============================================ */
.formula-editor {
    width: 100%;
}

.formula-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 10px;
}

.formula-table th {
    background-color: #f5f7fa;
    padding: 6px 8px;
    text-align: left;
    font-weight: normal;
    font-size: 13px;
    color: #909399;
    border-bottom: 1px solid #ebeef5;
}

.formula-table td {
    padding: 4px 6px;
    border-bottom: 1px solid #ebeef5;
}

.formula-table tbody tr {
    transition: background-color 0.3s;
    cursor: move;
}

.formula-table tbody tr:hover {
    background-color: #f5f7fa;
}

.formula-table tbody tr.dragging {
    opacity: 0.5;
    background-color: #ecf5ff;
}

.drag-handle {
    text-align: center;
    color: #909399;
    cursor: grab;
    font-size: 16px;
}

.drag-handle:active {
    cursor: grabbing;
}

.empty-message {
    text-align: center;
    color: #909399;
    padding: 20px !important;
}

.add-button-container {
    text-align: center;
    padding: 8px;
}

.add-hint {
    margin-left: 10px;
    color: #909399;
    font-size: 14px;
}

/* 层号输入单元格：保持内容水平排列且垂直居中，不影响行高 */
.layer-cell {
    display: inline-flex;
    align-items: center;
}
.dup-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    color: #fff;
    font-weight: 700;
    font-size: 12px;
    line-height: 16px;
    margin-right: 6px;
    user-select: none;
}

/* Element Plus 组件微调 */
.formula-table .el-input-number {
    height: 28px;
}

.formula-table .el-input-number .el-input__wrapper {
    padding: 0 8px;
}

.formula-table .el-select .el-input__wrapper {
    height: 28px;
    padding: 0 8px;
}

/* ============================================
   通用样式
   ============================================ */
.loading {
    text-align: center;
    padding: 50px;
    color: #666;
}

.tab-content {
    background: white;
    border-radius: 8px;
    padding: 4px 20px; /* 垂直压缩为 4px，左右保持 20px */
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.category-tabs {
    margin-bottom: 20px;
}

.view-toggle {
    float: right;
    margin-bottom: 20px;
}

/* ============================================
   通用次要信息样式
   ============================================ */
.meta-text {
    color: #909399;   /* Element Plus 次要文字色 */
    font-size: 12px;
    line-height: 1.4;
}

/* （已清理）重复层冲突提示旧样式 .dup-conflict */

/* ============================================
   全局紧凑化 Tabs（Element Plus）
   - 统一缩小标签高度 / 去掉 header 底部空隙
   - 激活标签与内容面板无缝衔接
============================================ */
.el-tabs__header { margin: 0; padding: 0; }
.el-tabs--card > .el-tabs__header .el-tabs__nav { border-bottom: 1px solid #e4e7ed; }
.el-tabs--card > .el-tabs__header .el-tabs__item {
    padding: 4px 14px; /* 压缩水平与垂直空间 */
    height: 30px;
    line-height: 22px;
    font-size: 14px; /* 字号保持 */
    transition: background-color .15s ease, color .15s ease;
}
.el-tabs--card > .el-tabs__header .el-tabs__item.is-active {
    background: #fff;
    border-bottom-color: #fff;
    position: relative;
    z-index: 2;
}
.el-tabs--card > .el-tabs__content { padding-top: 0; }
/* 内容容器与激活标签衔接：去掉上边圆角 */
.tab-content { border-top-left-radius: 0; border-top-right-radius: 0; margin-top: 0; }

/* 右侧动态工具按钮区域 */
.tab-tools {
    display: flex;
    align-items: center;
    gap: 8px;
    padding-right: 4px;
}
.el-tabs__header { display:flex; }
.el-tabs__header .el-tabs__nav-wrap { flex:1; }

/* 自定义替代 #extra 的悬浮工具栏 */
.tabs-wrapper { position:relative; }
.floating-tab-tools {
    position:absolute;
    top: var(--sw-gap-sm);
    right: var(--sw-gap-lg);
    display:flex;
    gap: var(--sw-gap-md);
    z-index:10;
}
.floating-tab-tools .el-button { padding:4px 10px; }
.floating-tab-tools .el-button + .el-button { margin-left:0; }

/* 顶部新增类按钮专用紫色（与其他工具区分） */
/* 新头部使用通用 add-button 样式（取代旧 floating-tab-tools 作用域限制） */
.add-button.el-button {
    background: var(--sw-add-btn-bg);
    border-color: var(--sw-add-btn-bg);
    color: #fff;
}
.add-button.el-button:hover {
    background: var(--sw-add-btn-bg-hover);
    border-color: var(--sw-add-btn-bg-hover);
    color:#fff;
}
.add-button.el-button:active, .add-button.el-button.is-active {
    background: var(--sw-add-btn-bg-active);
    border-color: var(--sw-add-btn-bg-active);
    color:#fff;
}
.add-button.el-button:focus-visible { box-shadow: 0 0 0 2px rgba(111,66,193,0.35); }

/* 双按钮切换组（视图 / 排序） */
.dual-toggle-group { display:inline-flex; border:1px solid var(--el-border-color, #dcdfe6); border-radius: var(--radius-sm); overflow:hidden; }
.dual-toggle-group .el-button { border:none; box-shadow:none; }
.dual-toggle-group .el-button + .el-button { margin-left:0; }

/* 方案名称内联展示 */
.inline-scheme-name {
    display: inline-flex;
    align-items: center;
    gap: 6px;
}
.inline-art-title {
    font-weight: 600;
}
.scheme-name-input { width:200px; display:inline-block; }
/* 统一：含重复提示的紧凑行 */
.dup-inline-row { display:flex; align-items:center; gap:8px; flex-wrap:nowrap; }
.dup-inline-row .short-inline-input, .short-inline-input { width:180px; }
.scheme-name-input { width:160px; }
.dup-msg { font-size:12px; color:#d93025; white-space:nowrap; }
.scheme-sep { margin:0 4px 0 4px; }
.scheme-bracket-end { margin-left:4px; }

/* 配方行对齐：名称列固定 ch 宽度，数量单位右侧对齐 */
.formula-lines { font-size:12px; line-height:1.3; }
.formula-lines .fl { display:flex; }
.formula-lines .fl-name {
    display:inline-block;
    min-width: calc(var(--max-name-ch, 0) * 1ch);
    padding-right:4px;
    box-sizing:border-box;
    font-family: "Microsoft YaHei", Arial, sans-serif;
}
.formula-lines .fl-amt { flex-shrink:0; font-variant-numeric: tabular-nums; }

/* 返回顶部按钮 */
.back-to-top {
    position: fixed;
    right: 20px;
    bottom: 24px;
    width: 42px;
    height: 42px;
    border-radius: 50%;
    background: #409EFF;
    border: none;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    color: #fff;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background .25s ease, transform .25s ease;
    z-index: 200;
}
.back-to-top:hover { background:#337FCC; transform:translateY(-2px); }
.back-to-top:active { transform:translateY(0); }

/* ============================================
   响应式设计
   ============================================ */
@media (max-width: 768px) {
    /* 移除旧自配/原料布局的响应式占位 */
}

/* ============================================
     配色方案对话框（紧凑样式）
     ============================================ */
.scheme-dialog .el-dialog__header {
        padding: 8px 12px;
        margin: 0;
        background: #f5f7fa;
        border-bottom: 1px solid #e5e7eb;
}
.scheme-dialog .el-dialog__title { font-size:14px; font-weight:600; }
.scheme-dialog .el-dialog__headerbtn { top: 0px; }
.scheme-dialog .el-dialog__body { padding: 12px 14px 14px; }
.scheme-dialog .el-form-item { margin-bottom: 10px; }
.scheme-dialog .el-form-item__label { font-size: 14px; padding-right: 6px; }
.scheme-dialog .scheme-name-row { display:flex; align-items:center; gap:4px; }
.scheme-dialog .scheme-name-row .bracket { color:#666; }
.scheme-dialog .scheme-name-row .el-input { max-width: 140px; }
.scheme-dialog .add-button-container { padding:4px 0 0; }

/* 映射表（层号 / 自配色号选择） */
table.mapping-table { width:100%; border-collapse:collapse; margin-top:4px; }
table.mapping-table th, table.mapping-table td { padding:4px 6px; font-size:14px; }
table.mapping-table th { background:#fafafa; font-weight:600; color:#444; }
table.mapping-table tbody tr:hover { background:#f9fafb; }
table.mapping-table tbody tr:last-child td { border-bottom:none; }
table.mapping-table td { border:1px solid #e5e7eb; }
table.mapping-table th { border:1px solid #e5e7eb; }
table.mapping-table .layer-cell { display:flex; align-items:center; gap:4px; }
table.mapping-table .layer-cell .el-input-number { width:70px; }
table.mapping-table .badge-slot { width:18px; display:inline-flex; justify-content:center; }
table.mapping-table .dup-badge { width:16px; height:16px; line-height:16px; font-size:11px; margin-right:0; }
table.mapping-table .el-select { width:100%; }
table.mapping-table .mapping-formula-chips { display:flex; flex-wrap:wrap; gap:4px; margin-top:4px; align-items:center; }
/* 通用 chip 容器（对话框 & 视图公用） */
.mapping-formula-chips { display:flex; flex-wrap:wrap; gap:var(--sw-chip-gap); margin-top:var(--sw-gap-sm); align-items:center; }
.mf-chip { background:#f0f4f8; border:1px solid #d6dee6; border-radius:3px; padding:1px 4px; font-size:12px; line-height:14px; white-space:nowrap; }
.usage-chip { background:#f5f7f2; border:1px solid #d9e2cc; color:#56624a; }
.usage-chips { display:inline-flex; flex-wrap:wrap; gap:var(--sw-chip-gap); }

/* 寻迹高亮动画（无突兀底色：1s 线性渐亮 + 1s 线性渐隐，始终只有动画，没有静态浅黄底） */
.highlight-pulse { position:relative; border-radius:4px; overflow:visible; animation:traceHighlight 2s linear 0s 1 forwards; }
/* 使用单一动画控制背景填充与外发光；不设置静态背景，避免突然出现/消失 */
@keyframes traceHighlight {
    0% { background-color:rgba(255,213,79,0); box-shadow:0 0 0 0 rgba(255,213,79,0); }
    /* 50%（1s）达到峰值 */
    50% { background-color:rgba(255,213,79,0.40); box-shadow:0 0 0 3px rgba(255,213,79,0.55), 0 0 14px 4px rgba(255,213,79,0.45); }
    /* 100%（2s）完全回落为无效果 */
    100% { background-color:rgba(255,213,79,0); box-shadow:0 0 0 0 rgba(255,213,79,0); }
}

/* 自配色优先视图专用紧凑表格 */
.bycolor-table { table-layout:auto; }
.bycolor-table th, .bycolor-table td { white-space:nowrap; vertical-align:top; }
.bycolor-table .formula-chip-row { padding:4px 6px; }
.bycolor-table .mapping-formula-chips { flex-wrap:nowrap; flex-direction:column; align-items:flex-start; gap:2px; overflow:visible; }
.bycolor-table .mapping-formula-chips .mf-chip { margin-right:0; }
.bycolor-table .layers-row .layers-cell { padding:2px 6px 6px; }
.bycolor-table .layers-line { display:flex; align-items:center; flex-wrap:nowrap; white-space:nowrap; }
.bycolor-table .layers-line .layer-cell { display:inline-flex; align-items:center; }
.bycolor-table .dup-badge { margin-right:2px; }
table.mapping-table td:nth-child(1) { width:80px; }
table.mapping-table td:nth-child(2) { width:260px; }
table.mapping-table td:nth-child(3) { width:110px; text-align:right; }

@media (max-width: 820px) {
    .scheme-dialog { width:95% !important; }
    table.mapping-table td:nth-child(2) { width:auto; }
}

/* Global search bar styling */
.global-search-bar { position: sticky; top: 64px; z-index: 120; background: rgba(255,255,255,0.85); backdrop-filter: blur(6px); padding: 8px 16px 4px; box-shadow: 0 2px 4px -2px rgba(0,0,0,0.08); }
.global-search-bar .el-input { max-width: 520px; }