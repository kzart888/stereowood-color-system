/* ============================================
   叠雕画颜色管理系统 - 样式表
   文件路径: frontend/css/styles.css
   ============================================ */

/* ============================================
   基础样式
   ============================================ */
body {
    font-family: 'Microsoft YaHei', Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f5f5f5;
}

/* ============================================
   统一浮动操作按钮 - STEREOWOOD Color System
   ============================================ */

/* === 返回顶部按钮 === */
#backToTopBtn,
.sw-float-btn {
    position: fixed;
    right: 18px;
    bottom: 22px;
    z-index: 1200;
    width: 48px;
    height: 48px;
    border: none;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--sw-primary), var(--sw-primary-active));
    color: var(--sw-bg-white);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: var(--sw-shadow-float);
    transition: all var(--sw-transition-slow);
}

#backToTopBtn:hover,
.sw-float-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(111,66,193,0.4);
}

#backToTopBtn:active,
.sw-float-btn:active {
    transform: translateY(0) scale(0.95);
}

/* ============================================
   设计系统变量 - STEREOWOOD Color System
   ============================================ */
:root {
    /* === 间距系统 === */
    --sw-gap-xs: 2px;
    --sw-gap-sm: 4px;
    --sw-gap-md: 6px;
    --sw-gap-lg: 8px;
    --sw-gap-xl: 12px;
    --sw-actions-gap: 8px; /* 统一工具按钮间距 */
    
    /* === 圆角系统 === */
    --sw-radius-xs: 2px;
    --sw-radius-sm: 4px;
    --sw-radius-md: 6px;
    --sw-radius-lg: 8px;
    
    /* === 布局系统 === */
    --sw-card-padding: 4px 6px 8px;
    --sw-header-padding: 6px 6px 4px;
    --sw-chip-gap: 4px;
    --sw-thumb-size: 80px;
    --sw-thumb-preview-size: 320px; /* 预览图尺寸 */
    
    /* === 颜色系统 === */
    --sw-primary: #6f42c1;              /* 主色调-紫色 */
    --sw-primary-hover: #5a34a0;        /* 主色-悬停 */
    --sw-primary-active: #4b2c85;       /* 主色-激活 */
    --sw-primary-light: rgba(111,66,193,0.12); /* 主色-浅色背景 */
    --sw-primary-border: rgba(111,66,193,0.25); /* 主色-边框 */
    
    --sw-success: #2f9e44;              /* 成功色 */
    --sw-warning: #f59e0b;              /* 警告色 */
    --sw-danger: #d93025;               /* 危险色 */
    --sw-info: #409EFF;                 /* 信息色 */
    
    --sw-text-primary: #222;            /* 主要文本 */
    --sw-text-secondary: #666;          /* 次要文本 */
    --sw-text-muted: #909399;           /* 辅助文本 */
    --sw-text-disabled: #c0c4cc;        /* 禁用文本 */
    
    --sw-border-light: #e4e7ed;         /* 浅边框 */
    --sw-border-base: #dcdfe6;          /* 基础边框 */
    --sw-border-dark: #c0c4cc;          /* 深边框 */
    
    --sw-bg-white: #fff;                /* 白色背景 */
    --sw-bg-light: #fafafa;             /* 浅灰背景 */
    --sw-bg-base: #f5f5f5;              /* 基础背景 */
    
    /* === 阴影系统 === */
    --sw-shadow-light: 0 1px 4px rgba(0,0,0,0.08);
    --sw-shadow-base: 0 2px 8px rgba(0,0,0,0.1);
    --sw-shadow-card: 0 1px 4px rgba(0,0,0,0.3);
    --sw-shadow-dialog: 0 4px 16px rgba(0,0,0,0.14);
    --sw-shadow-float: 0 6px 18px rgba(0,0,0,0.18);
    
    /* === 过渡动画 === */
    --sw-transition-fast: 0.15s ease;
    --sw-transition-base: 0.18s ease;
    --sw-transition-slow: 0.25s ease;
}

/* (已移除 sticky 顶部特性样式) */

/* [HEADER] Sticky 顶部栏与布局（搜索功能加入前的基础结构） */
.app-header-sticky { position:sticky; top:0; z-index:1000; background:transparent; backdrop-filter:none; border-bottom:none; box-shadow:none; }
/* 头部背景：采用伪元素实现全宽白底紧贴浏览器左右与顶部，不包裹成“孤岛” */
.app-header-sticky::before { content:""; position:absolute; inset:0; background:#fff; box-shadow:0 1px 4px rgba(0,0,0,0.08); pointer-events:none; }
/* 内部条保持原有 padding，不改布局 */
.app-header-bar { position:relative; }
.app-header-bar { display:grid; grid-template-columns:auto 1fr auto; align-items:end; gap:16px; padding:6px 14px 4px; }
.app-header-with-search { grid-template-columns:auto 1fr auto auto; align-items:end; }
.app-header-with-search .app-header-search { min-width:240px; max-width:360px; display:flex; align-items:center; }
.app-header-with-search .app-header-search .el-input { width:100%; }
@media (max-width: 1180px) {
    .app-header-with-search { grid-template-columns:1fr 1fr; grid-auto-rows:auto; }
    .app-header-with-search .app-header-left { grid-column:1 / span 2; }
    .app-header-with-search .app-header-center { order:2; }
    .app-header-with-search .app-header-tools { order:3; justify-content:flex-start; }
    .app-header-with-search .app-header-search { order:4; grid-column:1 / span 2; justify-content:center; padding-top:4px; }
}
@media (max-width: 720px) {
    .app-header-with-search { grid-template-columns:1fr; }
    .app-header-with-search .app-header-center { order:2; }
    .app-header-with-search .app-header-tools { order:3; flex-wrap:wrap; }
    .app-header-with-search .app-header-search { order:4; width:100%; max-width:none; }
}

/* 全局搜索下拉（阶段3基础样式） */
.global-search-dropdown { position:relative; z-index:1100; background:#fff; padding:6px 10px 10px; box-shadow:0 4px 14px rgba(0,0,0,0.12); border-bottom:1px solid #ececec; display:flex; flex-direction:column; gap:10px; box-sizing:border-box; }
/* 窄版浮层：单列布局，防止缩窄后右侧裁切 */
.global-search-dropdown.floating { position:absolute; top:100%; left:0; width:340px; max-width:85vw; margin-top:4px; border:1px solid #e4e4e4; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.18); }
.global-search-dropdown.floating.edge-shift { left:auto; right:0; }
.app-header-search { position:relative; }
.global-search-dropdown .gs-group { border:1px solid #eee; border-radius:6px; overflow:hidden; display:flex; flex-direction:column; background:#fafafa; }
.global-search-dropdown .gs-group-title { background:linear-gradient(135deg,#6f42c1,#5a34a0); color:#fff; font-size:12px; font-weight:600; padding:4px 8px; }
.global-search-dropdown .gs-items { max-height:240px; overflow:auto; display:flex; flex-direction:column; }
.global-search-dropdown .gs-item { font-size:12px; padding:4px 8px; cursor:pointer; line-height:1.3; display:flex; align-items:flex-start; }
.global-search-dropdown .gs-item + .gs-item { border-top:1px solid #eee; }
.global-search-dropdown .gs-item:hover, .global-search-dropdown .gs-item.active { background:#ece6f5; }
.global-search-dropdown .gs-text { color:#333; }
.app-header-left { display:flex; align-items:center; min-width:0; }
.app-title-badge { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); padding:6px 14px 6px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.12); }
.app-title { font-size:18px; margin:0; font-weight:600; white-space:nowrap; max-width:420px; overflow:hidden; text-overflow:ellipsis; color:#fff; }
.app-header-center { min-width:0; display:flex; }
/* ============================================
   统一Tab和切换系统 - STEREOWOOD Color System
   ============================================ */

/* === 自定义Tab按钮组 === */
.tab-switch-group,
.sw-tab-group {
    display: inline-flex;
    border-radius: var(--sw-radius-md);
    overflow: hidden;
    background: var(--sw-primary-light);
    box-shadow: 0 0 0 1px var(--sw-primary-border) inset;
}

.tab-switch-group .tab-switch,
.sw-tab-group .sw-tab {
    font: inherit;
    cursor: pointer;
    border: none;
    background: transparent;
    padding: 6px 14px;
    font-size: 13px;
    color: var(--sw-primary);
    line-height: 1;
    position: relative;
    transition: all var(--sw-transition-base);
}

.tab-switch-group .tab-switch + .tab-switch,
.sw-tab-group .sw-tab + .sw-tab {
    border-left: 1px solid var(--sw-primary-border);
}

.tab-switch-group .tab-switch.active,
.sw-tab-group .sw-tab.active {
    background: linear-gradient(135deg, var(--sw-primary), var(--sw-primary-hover));
    color: var(--sw-bg-white);
    box-shadow: 0 0 0 1px rgba(0,0,0,0.05) inset;
}

.tab-switch-group .tab-switch:not(.active):hover,
.sw-tab-group .sw-tab:not(.active):hover {
    background: rgba(111,66,193,0.18);
}

.tab-switch-group .tab-switch:focus-visible,
.sw-tab-group .sw-tab:focus-visible {
    outline: 2px solid rgba(111,66,193,0.55);
    outline-offset: -2px;
}
.app-header-tools { display:flex; align-items:center; gap:10px; flex-wrap:nowrap; }
.app-header-tools .dual-toggle-group { display:inline-flex; }
.app-header-tools .el-button + .el-button { margin-left:0 !important; }
@media (max-width: 980px) {
    .app-header-bar { grid-template-columns:1fr; grid-auto-rows:auto; }
    .app-header-center { order:2; justify-content:flex-start; }
    .app-header-tools { flex-wrap:wrap; order:3; }
}
.tab-panels-wrapper { padding:10px 4px 60px; }

.main-container {
    /* 全宽模式：去除固定最大宽度与水平居中，使下方三个 Tab 内容与顶部头部背景同宽 */
    width:100%;
    max-width:none;
    margin:0; /* 取消 auto 居中 */
    padding:8px 10px 12px; /* 保留极薄左右内边距，防止内容贴边 */
    box-sizing:border-box;
}

/* 全宽下 Tab 内容去除左右圆角，保证表格平铺对齐边界（顶部圆角已在激活标签衔接处移除） */
.main-container .tab-content { border-radius:0; padding-left:12px; padding-right:12px; }

.system-header {
    text-align: center;
    margin-bottom: 8px;
    padding: 12px 20px; /* compact vertical */
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 10px;
    color: white;
}
.system-header h1 {
    margin: 0;
    font-size: 20px;
    line-height: 1.2;
    font-weight: 600;
}
.system-header.compact p { display: none; }


/* ============================================
   统一卡片系统 - STEREOWOOD Color System
   ============================================ */

/* === 主卡片（作品/自配色条目） === */
.artwork-bar,
.sw-card {
    background: var(--sw-bg-white);
    margin: var(--sw-gap-md) var(--sw-gap-md) var(--sw-gap-lg) var(--sw-gap-md);
    border-radius: var(--sw-radius-md);
    box-shadow: var(--sw-shadow-card);
    overflow: hidden;
    padding: var(--sw-card-padding);
    transition: box-shadow var(--sw-transition-base);
}

.artwork-bar:hover,
.sw-card:hover {
    box-shadow: var(--sw-shadow-base);
}

/* === 卡片头部 === */
.artwork-header,
.sw-card-header {
    padding: var(--sw-header-padding);
    background: var(--sw-bg-light);
    border-bottom: 1px solid var(--sw-border-light);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.artwork-title,
.sw-card-title {
    font-size: 16px;
    font-weight: 600;
    color: var(--sw-text-primary);
    margin: 0;
}

/* === 卡片内容区域 === */
.sw-card-body {
    padding: var(--sw-gap-lg);
}

.sw-card-footer {
    padding: var(--sw-gap-md) var(--sw-gap-lg);
    background: var(--sw-bg-light);
    border-top: 1px solid var(--sw-border-light);
}

.color-actions { display:flex; align-items:center; gap: var(--sw-actions-gap); flex-shrink:0; }
.color-actions .el-button + .el-button { margin-left:0 !important; }
.inline-actions { display:flex; align-items:center; gap: var(--sw-actions-gap); }
.inline-actions .el-button + .el-button { margin-left:0 !important; }


/* 旧的 artwork 区域重复样式已移除，使用上方紧凑化版本 */

/* 方案块内边距 & 头部间距恢复为紧凑但不拥挤 */
.scheme-bar { padding:6px 6px 8px; border-bottom:1px solid #f0f0f0; }
.scheme-header { margin-bottom:6px; gap: var(--sw-actions-gap); }
/* 统一缩略图尺寸为 80x80 方形 */
.scheme-thumbnail { width: var(--sw-thumb-size); height: var(--sw-thumb-size); position:relative; display:flex; align-items:center; justify-content:center; font-size:12px; color:#777; }

/* 表格适度压缩行内边距 */
.layer-table th, .layer-table td { padding:6px 6px; }

.scheme-bar:last-child {
    border-bottom: none;
}

.scheme-header { display:flex; align-items:center; gap: var(--sw-actions-gap); margin-bottom:8px; }

.scheme-thumbnail {
    border-radius: var(--sw-radius-sm);
    border: 2px solid #ddd;
    background-size: cover;
    background-position: center;
    flex-shrink: 0;
    cursor: pointer;
}
.scheme-thumbnail.no-image { background:#fafafa; border-style:dashed; cursor: default; }

/* ============================================
   统一文本和状态系统 - STEREOWOOD Color System
   ============================================ */

/* === 文本层级 === */
.sw-text-primary { color: var(--sw-text-primary); }
.sw-text-secondary { color: var(--sw-text-secondary); }
.sw-text-muted { color: var(--sw-text-muted); }
.sw-text-disabled { color: var(--sw-text-disabled); }

/* === 状态文本 === */
.sw-text-success { color: var(--sw-success); }
.sw-text-warning { color: var(--sw-warning); }
.sw-text-danger { color: var(--sw-danger); }
.sw-text-info { color: var(--sw-info); }

/* === 表单提示系统 === */
.form-hint,
.sw-hint {
    font-size: 12px;
    color: var(--sw-text-muted);
    margin-top: var(--sw-gap-sm);
    line-height: 1.4;
}
.form-hint.success-hint,
.sw-hint.success {
    color: var(--sw-success);
}
.form-hint.error-hint,
.sw-hint.error {
    color: var(--sw-danger);
}
.sw-hint.warning {
    color: var(--sw-warning);
}

/* === 对话框表单优化 === */
.scheme-dialog .el-form-item__content .form-hint { flex-basis:100%; width:100%; }
.scheme-dialog .el-form-item__content { align-items:flex-start; }

/* ============================================
   统一缩略图系统 - STEREOWOOD Color System
   ============================================ */

/* === 缩略图容器 === */
.scheme-thumbnail,
.sw-thumbnail {
    width: var(--sw-thumb-size);
    height: var(--sw-thumb-size);
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    color: var(--sw-text-muted);
    border-radius: var(--sw-radius-sm);
    border: 2px solid var(--sw-border-light);
    background-size: cover;
    background-position: center;
    flex-shrink: 0;
    cursor: pointer;
    transition: all var(--sw-transition-base);
}

.scheme-thumbnail:hover,
.sw-thumbnail:hover {
    border-color: var(--sw-primary);
    box-shadow: var(--sw-shadow-light);
}

.scheme-thumbnail.no-image,
.sw-thumbnail.no-image {
    background: var(--sw-bg-light);
    border-style: dashed;
    cursor: default;
}

/* === 预览浮层 === */
.thumb-preview-overlay {
    position: fixed;
    width: var(--sw-thumb-preview-size);
    height: var(--sw-thumb-preview-size);
    background: var(--sw-bg-white) center/cover no-repeat;
    box-shadow: var(--sw-shadow-float);
    border: 2px solid var(--sw-bg-white);
    border-radius: var(--sw-radius-md);
    z-index: 4000;
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--sw-transition-fast);
}

.thumb-preview-overlay.show {
    opacity: 1;
    pointer-events: auto;
}

.thumb-preview-overlay::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: var(--sw-radius-md);
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.08);
}

.scheme-name {
    font-size: 16px;
    font-weight: bold;
    color: #409EFF;
}

/* 表格样式 */
.layer-table {
    width: 100%;
    border-collapse: collapse;
}

.layer-table th,
.layer-table td {
    border: 1px solid #ddd;
    padding: 4px;
    text-align: center;
    font-size: 12px;
}

.layer-table th {
    background: #f5f5f5;
    font-weight: bold;
}


/* ============================================
   配方编辑器样式
   ============================================ */
.formula-editor {
    width: 100%;
}

.formula-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 10px;
}

.formula-table th {
    background-color: #f5f7fa;
    padding: 6px 8px;
    text-align: left;
    font-weight: normal;
    font-size: 13px;
    color: #909399;
    border-bottom: 1px solid #ebeef5;
}

.formula-table td {
    padding: 4px 6px;
    border-bottom: 1px solid #ebeef5;
}

.formula-table tbody tr {
    transition: background-color 0.3s;
    cursor: move;
}

.formula-table tbody tr:hover {
    background-color: #f5f7fa;
}

.formula-table tbody tr.dragging {
    opacity: 0.5;
    background-color: #ecf5ff;
}

.drag-handle {
    text-align: center;
    color: #909399;
    cursor: grab;
    font-size: 16px;
}

.drag-handle:active {
    cursor: grabbing;
}

.empty-message {
    text-align: center;
    color: #909399;
    padding: 20px !important;
}

.add-button-container {
    text-align: center;
    padding: 8px;
}

.add-hint {
    margin-left: 10px;
    color: #909399;
    font-size: 14px;
}

/* 层号输入单元格：保持内容水平排列且垂直居中，不影响行高 */
.layer-cell {
    display: inline-flex;
    align-items: center;
}
.dup-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    color: #fff;
    font-weight: 700;
    font-size: 12px;
    line-height: 16px;
    margin-right: 6px;
    user-select: none;
}

/* Element Plus 组件微调 */
.formula-table .el-input-number {
    height: 28px;
}

.formula-table .el-input-number .el-input__wrapper {
    padding: 0 8px;
}

.formula-table .el-select .el-input__wrapper {
    height: 28px;
    padding: 0 8px;
}

/* ============================================
   通用样式
   ============================================ */
.loading {
    text-align: center;
    padding: 50px;
    color: #666;
}

.tab-content {
    background: white;
    border-radius: 8px;
    padding: 4px 20px; /* 垂直压缩为 4px，左右保持 20px */
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.category-tabs {
    margin-bottom: 20px;
}

/* === 分类筛选按钮组 === */
.category-switch-group {
    display: inline-flex;
    flex-wrap: wrap;
    gap: 0;
    margin: 0 0 var(--sw-gap-md) 0;
    background: var(--sw-primary-light);
    border-radius: var(--sw-radius-md);
    box-shadow: 0 0 0 1px var(--sw-primary-border) inset;
    overflow: hidden;
}

.category-switch-group .category-switch {
    font: inherit;
    cursor: pointer;
    border: none;
    background: transparent;
    padding: 6px 14px;
    font-size: 13px;
    color: var(--sw-primary);
    line-height: 1;
    position: relative;
    transition: all var(--sw-transition-base);
}

.category-switch-group .category-switch + .category-switch {
    border-left: 1px solid var(--sw-primary-border);
}

.category-switch-group .category-switch.active {
    background: linear-gradient(135deg, var(--sw-primary), var(--sw-primary-hover));
    color: var(--sw-bg-white);
    box-shadow: 0 0 0 1px rgba(0,0,0,0.05) inset;
}

.category-switch-group .category-switch:not(.active):hover {
    background: rgba(111,66,193,0.18);
}

.category-switch-group .category-switch:focus-visible {
    outline: 2px solid rgba(111,66,193,0.55);
    outline-offset: -2px;
}

.view-toggle {
    float: right;
    margin-bottom: 20px;
}

/* ============================================
   通用次要信息样式
   ============================================ */
.meta-text {
    color: #909399;   /* Element Plus 次要文字色 */
    font-size: 12px;
    line-height: 1.4;
}

/* （已清理）重复层冲突提示旧样式 .dup-conflict */

/* ============================================
   全局紧凑化 Tabs（Element Plus）
   - 统一缩小标签高度 / 去掉 header 底部空隙
   - 激活标签与内容面板无缝衔接
============================================ */
.el-tabs__header { margin: 0; padding: 0; }
.el-tabs--card > .el-tabs__header .el-tabs__nav { border-bottom: 1px solid #e4e7ed; }
.el-tabs--card > .el-tabs__header .el-tabs__item {
    padding: 4px 14px; /* 压缩水平与垂直空间 */
    height: 30px;
    line-height: 22px;
    font-size: 14px; /* 字号保持 */
    transition: background-color .15s ease, color .15s ease;
}
.el-tabs--card > .el-tabs__header .el-tabs__item.is-active {
    background: #fff;
    border-bottom-color: #fff;
    position: relative;
    z-index: 2;
}
.el-tabs--card > .el-tabs__content { padding-top: 0; }
/* 内容容器与激活标签衔接：去掉上边圆角 */
.tab-content { border-top-left-radius: 0; border-top-right-radius: 0; margin-top: 0; }

/* 右侧动态工具按钮区域 */
.tab-tools {
    display: flex;
    align-items: center;
    gap: 8px;
    padding-right: 4px;
}
.el-tabs__header { display:flex; }
.el-tabs__header .el-tabs__nav-wrap { flex:1; }

/* === 配方用量快速计算器浮层 (步骤3) === */
.sw-calc-layer { position:fixed; z-index:2400; min-width:360px; max-width:400px; background:#fff; box-shadow:0 4px 16px rgba(0,0,0,.14); border:1px solid #e5e7eb; border-radius:6px; font-size:12px; line-height:1.3; padding:6px 8px 10px; box-sizing:border-box; }
.sw-calc-layer .sw-calc-header { display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:4px; }
.sw-calc-layer .sw-calc-header .title { font-weight:600; font-size:13px; }
.sw-calc-layer .sw-calc-body { max-height:380px; overflow:auto; }
.sw-calc-table { width:100%; border-collapse:collapse; }
.sw-calc-table th, .sw-calc-table td { border:1px solid #e5e7eb; padding:4px 6px; text-align:center; }
.sw-calc-table th { background:#f5f5f5; font-weight:600; }
.sw-calc-table td.ing-name { text-align:left; }
.sw-calc-table td.ing-rem.neg { color:#d93025; font-weight:600; }
.sw-calc-table td.ing-rem.rebalance { color:#2e7d32; font-weight:600; }
.sw-calc-table tr.invalid td { opacity:.6; }
.sw-calc-layer .empty-msg { padding:20px 6px; text-align:center; color:#777; }
.sw-calc-layer .dim { color:#aaa; }
.sw-calc-table tr.total-row td { background:#fafafa; font-weight:600; }
.sw-calc-layer input.el-input__inner { padding:0 4px !important; }
.sw-calc-layer .el-input--small .el-input__wrapper { padding:0 4px; box-shadow:none; }
/* 方案/自配色内嵌 '算' / '计算' 按钮样式 */
.calc-mini-btn { position:absolute; top:2px; right:4px; border:none; background:#6f42c1; color:#fff; font-size:11px; line-height:1; padding:2px 4px; border-radius:4px; cursor:pointer; opacity:0.85; transition:background .18s ease, opacity .18s ease; }
.calc-mini-btn:hover { background:#5a34a0; opacity:1; }
.calc-mini-btn:active { background:#4b2c85; }

/* 自定义替代 #extra 的悬浮工具栏 */
.tabs-wrapper { position:relative; }
.floating-tab-tools {
    position:absolute;
    top: var(--sw-gap-sm);
    right: var(--sw-gap-lg);
    display:flex;
    gap: var(--sw-gap-md);
    z-index:10;
}
.floating-tab-tools .el-button { padding:4px 10px; }
.floating-tab-tools .el-button + .el-button { margin-left:0; }

/* ============================================
   统一按钮系统 - STEREOWOOD Color System
   ============================================ */

/* === 主色按钮（新增/主要操作） === */
.add-button.el-button,
.sw-btn-primary.el-button {
    background: var(--sw-primary);
    border-color: var(--sw-primary);
    color: var(--sw-bg-white);
    transition: all var(--sw-transition-base);
}
.add-button.el-button:hover,
.sw-btn-primary.el-button:hover {
    background: var(--sw-primary-hover);
    border-color: var(--sw-primary-hover);
    color: var(--sw-bg-white);
}
.add-button.el-button:active,
.add-button.el-button.is-active,
.sw-btn-primary.el-button:active,
.sw-btn-primary.el-button.is-active {
    background: var(--sw-primary-active);
    border-color: var(--sw-primary-active);
    color: var(--sw-bg-white);
}
.add-button.el-button:focus-visible,
.sw-btn-primary.el-button:focus-visible {
    box-shadow: 0 0 0 2px rgba(111,66,193,0.35);
}

/* === 次要按钮（常规操作） === */
.sw-btn-secondary.el-button {
    background: var(--sw-bg-white);
    border-color: var(--sw-border-base);
    color: var(--sw-text-primary);
    transition: all var(--sw-transition-base);
}
.sw-btn-secondary.el-button:hover {
    background: var(--sw-bg-light);
    border-color: var(--sw-primary);
    color: var(--sw-primary);
}

/* === 危险按钮（删除操作） === */
.sw-btn-danger.el-button {
    background: var(--sw-danger);
    border-color: var(--sw-danger);
    color: var(--sw-bg-white);
    transition: all var(--sw-transition-base);
}
.sw-btn-danger.el-button:hover {
    background: #c1251a;
    border-color: #c1251a;
    color: var(--sw-bg-white);
}

/* === 成功按钮（保存/确认操作） === */
.sw-btn-success.el-button {
    background: var(--sw-success);
    border-color: var(--sw-success);
    color: var(--sw-bg-white);
    transition: all var(--sw-transition-base);
}
.sw-btn-success.el-button:hover {
    background: #268e3a;
    border-color: #268e3a;
    color: var(--sw-bg-white);
}

/* === 按钮尺寸统一 === */
.sw-btn-xs.el-button { padding: 2px 6px; font-size: 12px; }
.sw-btn-sm.el-button { padding: 4px 8px; font-size: 12px; }
.sw-btn-md.el-button { padding: 6px 12px; font-size: 14px; }
.sw-btn-lg.el-button { padding: 8px 16px; font-size: 14px; }

/* 双按钮切换组（视图 / 排序） */
.dual-toggle-group { display:inline-flex; border:1px solid var(--el-border-color, #dcdfe6); border-radius: var(--radius-sm); overflow:hidden; }
.dual-toggle-group .el-button { border:none; box-shadow:none; }
.dual-toggle-group .el-button + .el-button { margin-left:0; }

/* 方案名称内联展示 */
.inline-scheme-name {
    display: inline-flex;
    align-items: center;
    gap: 6px;
}
.inline-art-title {
    font-weight: 600;
}
.scheme-name-input { width:200px; display:inline-block; }
/* 统一：含重复提示的紧凑行 */
.dup-inline-row { display:flex; align-items:center; gap:8px; flex-wrap:nowrap; }
.dup-inline-row .short-inline-input, .short-inline-input { width:180px; }
.scheme-name-input { width:160px; }
.dup-msg { font-size:12px; color:#d93025; white-space:nowrap; }
.scheme-sep { margin:0 4px 0 4px; }
.scheme-bracket-end { margin-left:4px; }

/* 配方行对齐：名称列固定 ch 宽度，数量单位右侧对齐 */
.formula-lines { font-size:12px; line-height:1.3; }
.formula-lines .fl { display:flex; }
.formula-lines .fl-name {
    display:inline-block;
    min-width: calc(var(--max-name-ch, 0) * 1ch);
    padding-right:4px;
    box-sizing:border-box;
    font-family: "Microsoft YaHei", Arial, sans-serif;
}
.formula-lines .fl-amt { flex-shrink:0; font-variant-numeric: tabular-nums; }

/* 返回顶部按钮 */
.back-to-top {
    position: fixed;
    right: 20px;
    bottom: 24px;
    width: 42px;
    height: 42px;
    border-radius: 50%;
    background: #409EFF;
    border: none;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    color: #fff;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background .25s ease, transform .25s ease;
    z-index: 200;
}
.back-to-top:hover { background:#337FCC; transform:translateY(-2px); }
.back-to-top:active { transform:translateY(0); }

/* ============================================
   响应式设计优化 - STEREOWOOD Color System
   ============================================ */

/* === 平板设备优化 (768px-1024px) === */
@media (max-width: 1024px) {
    .main-container {
        padding: var(--sw-gap-md) var(--sw-gap-lg) var(--sw-gap-xl);
    }
    
    .artwork-bar,
    .sw-card {
        margin: var(--sw-gap-sm) var(--sw-gap-sm) var(--sw-gap-md) var(--sw-gap-sm);
    }
}

/* === 移动设备优化 (≤768px) === */
@media (max-width: 768px) {
    .main-container {
        padding: var(--sw-gap-sm) var(--sw-gap-md) var(--sw-gap-lg);
    }
    
    .artwork-bar,
    .sw-card {
        margin: var(--sw-gap-xs) var(--sw-gap-xs) var(--sw-gap-sm) var(--sw-gap-xs);
    }
    
    .color-actions {
        flex-wrap: wrap;
        gap: var(--sw-gap-sm);
    }
    
    .category-switch-group {
        width: 100%;
        justify-content: center;
    }
    
    .category-switch-group .category-switch {
        flex: 1;
        text-align: center;
        min-width: 0;
    }
    
    .scheme-thumbnail,
    .sw-thumbnail {
        width: 60px;
        height: 60px;
    }
    
    .thumb-preview-overlay {
        width: 280px;
        height: 280px;
    }
}

/* === 小屏手机优化 (≤480px) === */
@media (max-width: 480px) {
    .sw-btn-md.el-button,
    .sw-btn-lg.el-button {
        padding: var(--sw-gap-sm) var(--sw-gap-md);
        font-size: 13px;
    }
    
    .artwork-title,
    .sw-card-title {
        font-size: 14px;
    }
    
    #backToTopBtn,
    .sw-float-btn {
        width: 42px;
        height: 42px;
        right: 12px;
        bottom: 12px;
    }
}

/* ============================================
     配色方案对话框（紧凑样式）
     ============================================ */
.scheme-dialog .el-dialog__header {
        padding: 8px 12px;
        margin: 0;
        background: #f5f7fa;
        border-bottom: 1px solid #e5e7eb;
}
.scheme-dialog .el-dialog__title { font-size:14px; font-weight:600; }
.scheme-dialog .el-dialog__headerbtn { top: 0px; }
.scheme-dialog .el-dialog__body { padding: 12px 14px 14px; }
.scheme-dialog .el-form-item { margin-bottom: 10px; }
.scheme-dialog .el-form-item__label { font-size: 14px; padding-right: 6px; }
.scheme-dialog .scheme-name-row { display:flex; align-items:center; gap:4px; }
.scheme-dialog .scheme-name-row .bracket { color:#666; }
.scheme-dialog .scheme-name-row .el-input { max-width: 140px; }
.scheme-dialog .add-button-container { padding:4px 0 0; }

/* 映射表（层号 / 自配色号选择） */
table.mapping-table { width:100%; border-collapse:collapse; margin-top:4px; }
table.mapping-table th, table.mapping-table td { padding:4px 6px; font-size:14px; }
table.mapping-table th { background:#fafafa; font-weight:600; color:#444; }
table.mapping-table tbody tr:hover { background:#f9fafb; }
table.mapping-table tbody tr:last-child td { border-bottom:none; }
table.mapping-table td { border:1px solid #e5e7eb; }
table.mapping-table th { border:1px solid #e5e7eb; }
table.mapping-table .layer-cell { display:flex; align-items:center; gap:4px; }
table.mapping-table .layer-cell .el-input-number { width:70px; }
table.mapping-table .badge-slot { width:18px; display:inline-flex; justify-content:center; }
table.mapping-table .dup-badge { width:16px; height:16px; line-height:16px; font-size:11px; margin-right:0; }
table.mapping-table .el-select { width:100%; }
table.mapping-table .mapping-formula-chips { display:flex; flex-wrap:wrap; gap:4px; margin-top:4px; align-items:center; }
/* 通用 chip 容器（对话框 & 视图公用） */
.mapping-formula-chips { display:flex; flex-wrap:wrap; gap:var(--sw-chip-gap); margin-top:var(--sw-gap-sm); align-items:center; }
.mf-chip { background:#f0f4f8; border:1px solid #d6dee6; border-radius:3px; padding:1px 4px; font-size:12px; line-height:14px; white-space:nowrap; }
.mf-chip,[data-no-tip] { /* 统一禁用 Element Plus tooltip pointer 触发，使 hover 不再出现黑色气泡 */ -webkit-touch-callout:none; }
/* 若有残留 tooltip，通过覆盖 popper 可见性隐藏（作用范围限定为 chip） */
.el-popper.is-dark[data-chip-tip], .el-popper.is-dark[data-chip-tip] * { display:none !important; }
.usage-chip { background:#f5f7f2; border:1px solid #d9e2cc; color:#56624a; }
.usage-chips { display:inline-flex; flex-wrap:wrap; gap:var(--sw-chip-gap); }

/* 寻迹高亮动画（无突兀底色：1s 线性渐亮 + 1s 线性渐隐，始终只有动画，没有静态浅黄底） */
.highlight-pulse { position:relative; border-radius:4px; overflow:visible; animation:traceHighlight 2s linear 0s 1 forwards; }
/* 使用单一动画控制背景填充与外发光；不设置静态背景，避免突然出现/消失 */
@keyframes traceHighlight {
    0% { background-color:rgba(255,213,79,0); box-shadow:0 0 0 0 rgba(255,213,79,0); }
    /* 50%（1s）达到峰值 */
    50% { background-color:rgba(255,213,79,0.40); box-shadow:0 0 0 3px rgba(255,213,79,0.55), 0 0 14px 4px rgba(255,213,79,0.45); }
    /* 100%（2s）完全回落为无效果 */
    100% { background-color:rgba(255,213,79,0); box-shadow:0 0 0 0 rgba(255,213,79,0); }
}

/* 自配色优先视图专用紧凑表格 */
.bycolor-table { table-layout:auto; }
.bycolor-table th, .bycolor-table td { white-space:nowrap; vertical-align:top; }
.bycolor-table .formula-chip-row { padding:4px 6px; }
.bycolor-table .mapping-formula-chips { flex-wrap:nowrap; flex-direction:column; align-items:flex-start; gap:2px; overflow:visible; }
.bycolor-table .mapping-formula-chips .mf-chip { margin-right:0; }
.bycolor-table .layers-row .layers-cell { padding:2px 6px 6px; }
.bycolor-table .layers-line { display:flex; align-items:center; flex-wrap:nowrap; white-space:nowrap; }
.bycolor-table .layers-line .layer-cell { display:inline-flex; align-items:center; }
.bycolor-table .dup-badge { margin-right:2px; }
table.mapping-table td:nth-child(1) { width:80px; }
table.mapping-table td:nth-child(2) { width:260px; }
table.mapping-table td:nth-child(3) { width:110px; text-align:right; }

@media (max-width: 820px) {
    .scheme-dialog { width:95% !important; }
    table.mapping-table td:nth-child(2) { width:auto; }
}

/* Global search bar styling */
.global-search-bar { position: sticky; top: 64px; z-index: 120; background: rgba(255,255,255,0.85); backdrop-filter: blur(6px); padding: 8px 16px 4px; box-shadow: 0 2px 4px -2px rgba(0,0,0,0.08); }
.global-search-bar .el-input { max-width: 520px; }

/* ============================================
   统一表单必填校验错误（对话框内）右侧内联样式
   适用：自配色 / 配色方案 / 原料 对话框 (均使用 .scheme-dialog 类)
   ============================================ */
.scheme-dialog .el-form-item { align-items: flex-start; }
.scheme-dialog .el-form-item__content { display:flex; align-items:center; flex-wrap:wrap; }
.scheme-dialog .el-form-item__error {
    position: static !important; /* 取消默认绝对定位 */
    display: inline-block;
    margin: 0 0 0 8px; /* 与输入框间距 */
    padding: 0; /* 去除底部额外空间 */
    line-height: 1.2;
    font-size: 12px;
    color: #d93025; /* 统一错误红色，与重复提示一致 */
    white-space: nowrap; /* 单行显示 */
}
/* 当内容本身为多行（如内联方案名组合），保持整体换行但错误跟随其后 */
.scheme-dialog .inline-scheme-name + .el-form-item__error { align-self:center; }

/* === 配方查重对话框 (比例) === */
.dup-groups-dialog .el-dialog__body { padding:12px 14px 14px; max-height:70vh; overflow:auto; }
.dup-groups-wrapper { display:flex; flex-direction:column; gap:12px; }
.dup-group-block { border:1px solid #e1e5ec; border-radius:6px; background:#fafbfc; padding:8px 10px 10px; box-shadow:0 1px 2px rgba(0,0,0,0.04); }
.dup-group-head { display:flex; align-items:center; flex-wrap:wrap; gap:8px; margin-bottom:6px; }
.dup-group-badge { background:linear-gradient(135deg,#6f42c1,#5a34a0); color:#fff; font-size:12px; font-weight:600; padding:2px 10px; border-radius:20px; }
.dup-group-formula .el-tag { margin:0 6px 6px 0; }
.dup-records { display:flex; flex-direction:column; gap:4px; }
.dup-record-row { display:flex; align-items:center; gap:12px; font-size:12px; padding:4px 6px; background:#fff; border:1px solid #e5e7eb; border-radius:4px; }
.dup-record-row.is-referenced { background:#f1f7ef; border-color:#c6e3bb; }
.dup-record-row .code { font-weight:600; cursor:pointer; }
.dup-record-row .code:hover { text-decoration:underline; }
.dup-record-row .ref-flag { font-size:11px; color:#2f6f1d; background:#dcefd4; padding:2px 6px; border-radius:12px; }
.dup-group-foot { margin-top:4px; }
.dup-groups-dialog .el-dialog__footer { padding:8px 14px 14px; }

/* ============================================
   色彩列表对话框样式
   ============================================ */
.color-palette-dialog .el-dialog__header {
    padding: 12px 16px;
    border-bottom: 1px solid #e4e7ed;
}

.color-palette-dialog .el-dialog__body {
    padding: 16px;
    max-height: 80vh;
    overflow-y: auto;
}

.custom-dialog-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
}

.palette-title {
    font-size: 18px;
    font-weight: 600;
    color: #303133;
}

.palette-header-right {
    display: flex;
    align-items: center;
    gap: 12px;
}

.palette-stats {
    font-size: 13px;
    color: #909399;
}

.close-btn {
    margin-left: 8px;
}

.color-palette-content {
    padding: 0;
}

.empty-palette {
    text-align: center;
    color: #909399;
    font-size: 14px;
    padding: 40px 20px;
}

.palette-main {
    display: flex;
    flex-direction: column;
    gap: 0;
}

.palette-group {
    margin-bottom: 0;
}

.palette-group.group-spacing {
    margin-top: 14px;
}

.group-layout {
    display: flex;
    align-items: flex-start;
    gap: 16px;
}

.group-label {
    writing-mode: vertical-lr;
    text-orientation: mixed;
    font-size: 16px;
    font-weight: 600;
    color: #303133;
    background: #f8f9fa;
    padding: 8px 4px;
    border-radius: 4px;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
    flex-shrink: 0;
}

.group-colors {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    flex: 1;
}

.color-item {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.color-block {
    width: 70px;
    height: 70px;
    border-radius: 4px;
    overflow: hidden;
    position: relative;
    margin-bottom: 4px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.color-preview-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.no-image-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f5f5f5;
    color: #909399;
    font-size: 10px;
    text-align: center;
    line-height: 1.2;
    padding: 4px;
}

.color-name {
    font-weight: 500;
    font-size: 12px;
    color: #303133;
    text-align: center;
    line-height: 1.2;
}


/* ============================================
   打印样式
   ============================================ */
@media print {
    /* 重置页面样式 */
    * {
        box-sizing: border-box;
    }
    
    html, body {
        width: 100% !important;
        height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        overflow: visible !important;
        background: white !important;
    }
    
    /* 隐藏不需要的元素 */
    body > *:not(.el-overlay),
    .app-header-sticky,
    .main-container > div:not([class*="color-palette"]),
    #backToTopBtn {
        display: none !important;
    }
    
    /* 确保对话框遮罩层显示 */
    .el-overlay {
        position: static !important;
        background: white !important;
        z-index: auto !important;
        display: block !important;
        visibility: visible !important;
    }
    
    /* 确保色彩对话框及其内容显示 */
    .color-palette-dialog,
    .color-palette-dialog *,
    .el-dialog,
    .el-dialog * {
        visibility: visible !important;
    }
    
    /* 保持必要的flex布局 */
    .custom-dialog-header,
    .palette-header-right,
    .group-layout,
    .group-colors,
    .color-item {
        display: flex !important;
    }
    
    /* 保持块级显示 */
    .color-palette-dialog,
    .el-dialog,
    .el-dialog__wrapper,
    .el-dialog__header,
    .el-dialog__body,
    .color-palette-content,
    .palette-main,
    .palette-group {
        display: block !important;
    }
    
    /* 对话框包装器 */
    .color-palette-dialog .el-dialog__wrapper {
        position: static !important;
        background: white !important;
        padding: 0 !important;
        margin: 0 !important;
        width: 100% !important;
        height: auto !important;
        display: block !important;
        overflow: visible !important;
    }
    
    /* 对话框主体 */
    .color-palette-dialog .el-dialog {
        position: static !important;
        top: auto !important;
        left: auto !important;
        right: auto !important;
        bottom: auto !important;
        transform: none !important;
        margin: 0 !important;
        width: 100% !important;
        max-width: none !important;
        height: auto !important;
        max-height: none !important;
        box-shadow: none !important;
        border: none !important;
        border-radius: 0 !important;
        display: block !important;
        overflow: visible !important;
    }
    
    /* 对话框头部 */
    .color-palette-dialog .el-dialog__header {
        padding: 10px 15px !important;
        border-bottom: 2px solid #333 !important;
        background: white !important;
        display: block !important;
        position: static !important;
    }
    
    /* 隐藏按钮 */
    .palette-header-right .el-button {
        display: none !important;
    }
    
    .custom-dialog-header {
        justify-content: center !important;
        display: flex !important;
    }
    
    /* 对话框内容 */
    .color-palette-dialog .el-dialog__body {
        padding: 15px !important;
        max-height: none !important;
        overflow: visible !important;
        height: auto !important;
        display: block !important;
        position: static !important;
    }
    
    /* 内容区域 */
    .color-palette-content {
        display: block !important;
        overflow: visible !important;
        height: auto !important;
    }
    
    .palette-main {
        display: block !important;
        overflow: visible !important;
        height: auto !important;
    }
    
    .palette-title {
        font-size: 20px !important;
        font-weight: bold !important;
        color: #000 !important;
    }
    
    .palette-stats {
        font-size: 14px !important;
        color: #666 !important;
        margin-left: 20px !important;
    }
    
    /* 分组样式 */
    .palette-group {
        display: block !important;
        page-break-inside: avoid;
        margin-bottom: 0 !important;
    }
    
    .palette-group.group-spacing {
        margin-top: 20px !important;
    }
    
    .group-layout {
        display: flex !important;
        gap: 12px !important;
        align-items: flex-start !important;
    }
    
    .group-label {
        font-size: 14px !important;
        font-weight: bold !important;
        color: #000 !important;
        background: #f0f0f0 !important;
        border: 1px solid #ccc !important;
        min-height: 60px !important;
        writing-mode: vertical-lr !important;
        text-orientation: mixed !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 8px 4px !important;
        flex-shrink: 0 !important;
    }
    
    .group-colors {
        display: flex !important;
        flex-wrap: wrap !important;
        gap: 6px !important;
        flex: 1 !important;
    }
    
    .color-item {
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        break-inside: avoid;
        page-break-inside: avoid;
    }
    
    .color-block {
        width: 50px !important;
        height: 50px !important;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2) !important;
        border-radius: 4px !important;
        overflow: hidden !important;
        margin-bottom: 3px !important;
    }
    
    .color-preview-image {
        width: 100% !important;
        height: 100% !important;
        object-fit: cover !important;
        display: block !important;
    }
    
    .no-image-placeholder {
        width: 100% !important;
        height: 100% !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        background: #f5f5f5 !important;
        font-size: 8px !important;
        text-align: center !important;
        padding: 2px !important;
    }
    
    .color-name {
        font-size: 9px !important;
        color: #000 !important;
        font-weight: bold !important;
        text-align: center !important;
        line-height: 1.2 !important;
    }
}
